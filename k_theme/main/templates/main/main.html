{% load static %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function previewImage() {
        var fileInput = document.getElementById('image-input');
        var imagePreview = document.getElementById('image-preview');

        // Check if a file is selected
        if (fileInput.files && fileInput.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                imagePreview.innerHTML = '<img src="' + e.target.result + '" alt="Image Preview" style="max-width: 100%; max-height: 200px;">';
            };

            reader.readAsDataURL(fileInput.files[0]);
        } else {
            imagePreview.innerHTML = ''; // Clear the image preview if no file is selected
        }
    }
</script>

<style>
    .square {
        width: 100px;
        height: 100px;
        border: 1px solid #000;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        overflow: hidden;
        position: relative;
    }

    .square img {
        max-width: 100%;
        max-height: 100%;
    }

    .squares-container {
        display: flex;
        flex-wrap: wrap;
    }

    .placeholder-image {
        /* position: absolute;
        width: 100%;
        height: 100%; */
    }

    .hidden-file-input {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        cursor: pointer;
    }

    .image-label {
        display: inline-block;
        cursor: pointer;
    }

    .image-label img {
        max-width: 100%;
        height: auto;
    }
</style>
<div class="squares-container">
    {% for image_path in image_paths %}
    <form method="post" enctype="multipart/form-data" action="{% url 'main' %}">
        {% csrf_token %}
        <input type="hidden" name="image_path" value="{{ image_path }}">
        <div class="square">
            <input type="file" name="image_upload" id="file-input-{{ forloop.counter }}" class="hidden-file-input">
            <label for="file-input-{{ forloop.counter }}" class="image-label" data-image-path="{{ image_path }}">
                <img src="{{ image_path }}" alt="Image" class="image-preview">
            </label>
        </div>
        <p>{{ image_path }}</p>
        <button type="submit" name="action" value="upload_images">Upload</button>
    </form>
    {% endfor %}
</div>

<h2>Modify CSS</h2>
<form method="post">
    {% csrf_token %}
    {{ color_form.as_p }}
    <button type="submit" name="action" value="create_css">Create CSS</button>
</form>

<h2>Create ZIP</h2>
<form method="post">
    {% csrf_token %}
    <button type="submit" name="action" value="create_zip">Create ZIP</button>
</form>